## 介绍

帮助分列与分行的Excel插件

![demo](demo.png)

## 背景

一些地方仍然采用Excel集中进行数据处理，并且会出现适用于人类而非机器的数据格式

xyq本人会先尝试用Excel来处理（例如本工具的功能其实都能通过PowerQuery实现），然后考虑将表格当做csv用Python处理

至于为什么要写一个Excel插件，这是因为普通用户抗拒上面的两种方法

本工具仅提供一种可选的解决方案，按照xyq的经验，现实场景中这种Excel同时还会出现各种奇怪的格式，比如说全半角不统一，意义不明的空白符等问题

本项目的基础框架VSTO属于是正在过时的技术，甚至GUI默认都是WinForm，xyq选择这个而非Web add-ins是因为那个发布起来太麻烦了

## 功能介绍

### 核心功能

处理类似这样的数据：

| 角色 | 能力列表 |
|---|---|
| sanae | 料理(Lv.1),战斗(Lv.3),话术(Lv.3) |
| daiyosei | 采集(Lv.3),钓鱼(Lv.1) |

将其转换为下面的数据：

| 角色 | 能力 | 等级 |
|---|---|---|
| sanae | 料理 | 1 |
| sanae | 战斗 | 3 |
| sanae | 话术 | 3 |
| daiyosei | 采集 | 3 |
| daiyosei | 钓鱼 | 1 |

或者是分列的形式：

| 角色 | 能力1 | 等级1 | 能力2 | 等级2 | 能力3 | 等级3 |
|---|---|---|---|---|---|---|
| sanae | 料理 | 1 | 战斗 | 3 | 话术 | 3 |
| daiyosei | 采集 | 3 | 钓鱼 | 1 | | |

虽然用Excel本身就能轻易做到以上功能，但是此插件也许可以节约一些操作数。

操作的关键步骤分为两步：

1. 分隔。按照给出的分隔符（比如逗号之类）将每个单元格的内容分隔为多个部分
2. 提取。对于每个分隔出的部分，按照一定的规则提取出多个内容

### 预览

插件会试图寻找第一个非空单元格作为示例，显示此部分的分行结果

### 空白处理

在分隔之前，可以选中“不处理空白输入”跳过那些单元格为空的行

“当所有提取项结果为空时，跳过”这个选项在完成提取处理之后触发，如果某个分隔部分提取出的所有值都是空值，那么会跳过这个分隔部分的保存

### 后处理

在完成提取后，可以对提取结果进行进一步处理。目前支持的后处理仅有提取省份功能

### 过滤重复项

此功能面向的需求是要求提取出项目与前面某一列冲突时，应当废弃此分隔部分。举个例子：

| 角色 | 天赋能力 | 能力列表 |
|---|---|---|
| sanae | 话术 | 料理(Lv.1),战斗(Lv.3),话术(Lv.3) |
| daiyosei | 采集 | 采集(Lv.3),钓鱼(Lv.1) |

只想保存非天赋能力的话，可以点击“过滤重复项”文本框来选中需要比较的目标列

### 限制提取结果数量

其实就是限制分隔次数，不过这里考虑在处理过程中会过滤掉某些分隔部分的情况

### 预设

如果你有固定的文件格式需要处理，那么可以在“分列向导”这个窗口中保存某次分列的参数，并且在“预设”窗口中加载

PS：预设的默认保存路径是`C:\Users\[username]\AppData\Local\Apps\2.0\Data\[something]\[something else]\exce..vsto_...\Data\[excel version]`

## 目前问题

* 没有测试过表格中包含非文本内容的情况，大概率会出问题
* 仅适用于表格从第一行开始

## TODO

* 支持从任意行开始
* 可将预设批量应用于多个文件

## 其他

因为没写单元测试什么的也没有试很多用例所以可能有很多bug，欢迎反馈
